Ho effettuato del refactoring sul tuo codice. Fai caso a come progressivamente le duplicazioni sono sparite. 
Il design Ã¨ migliorato progressivamente e non ho modificato niente della tua implementazione. 